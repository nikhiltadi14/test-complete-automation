import random
import Login_Window, Home_Window, SetupAndConfiguration_Popup

def CreateNewUser():  
  Login_Window.launchVIMonitorPlusApplication()
  Login_Window.loginInToApplication("Administrator",Project.Variables.Password.DecryptedValue,"Multiple Servers","demoip.com","4021")
  Home_Window.verifyThatSpecifiedUserIsLoggedInCorrectly("Administrator")
  Home_Window.waitForCamerasToLoadInLeftTreeView()
  Home_Window.navigateToSetupAndConfigurationPopup()
  SetupAndConfiguration_Popup.verifyThatSetupAndConfigurationPopupIsDisplayed()
  SetupAndConfiguration_Popup.clickOnAddUserButton()
  SetupAndConfiguration_Popup.verifyThatUserInformationAndPermissionsSectionIsDisplayed()
  SetupAndConfiguration_Popup.verifyThatUserIDIsAutoGenerated()
  sRand = str(random.randint(0,5000))
  SetupAndConfiguration_Popup.enterNonAdminUserDetails("Vikas"+sRand,"Vol"+sRand,"v"+sRand+"@gmail.com",Project.Variables.Password.DecryptedValue,"5")
  SetupAndConfiguration_Popup.verifyThatUserDetailsAreEnteredCorrectly("Vikas"+sRand,"Vol"+sRand,"v"+sRand+"@gmail.com",Project.Variables.Password.DecryptedValue,"5")
  SetupAndConfiguration_Popup.selectCamerasAndItsPermissions()
  SetupAndConfiguration_Popup.verifyThatCameraPermissionsAreSelectedCorrectly()
  SetupAndConfiguration_Popup.selectOtherResourcesPermissions()
  SetupAndConfiguration_Popup.verifyThatOtherResourcesAreSelectedCorrectly()
  SetupAndConfiguration_Popup.clickSaveButtonOnUserCreationPopup()
  SetupAndConfiguration_Popup.closeSecuritySetupPopup()
  Home_Window.logOutOfTheApplication()
    
  Login_Window.loginInToApplication("Vikas"+sRand,Project.Variables.Password.DecryptedValue,"Multiple Servers","demoip.com","4021")
  Home_Window.verifyThatSpecifiedUserIsLoggedInCorrectly("Vikas"+sRand)
  Home_Window.waitForCamerasToLoadInLeftTreeView()
  Home_Window.verifyThatSpecifiedCamerasAreDisplayed()
  Home_Window.verifyThatLiveAndRecordOptionIsDisplayedForParkingCamera()
  Home_Window.verifyThatRecordedViewIsNotDisplayedForSecondCamera()
  Home_Window.verifyThatSelectedViewIsDisplayedCorrectly()
  Home_Window.verifyThatSelectedMapIsDisplayedCorrectly()
  Home_Window.logOutOfTheApplication()
  Login_Window.closeTheApplication()